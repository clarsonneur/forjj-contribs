---
plugin: "jenkins"
version: "0.1"
description: "CI jenkins plugin for FORJJ."
runtime:
  docker:
    image: "hub.docker.hpecorp.net/devops/forjj-jenkins"
    dood: true
  service_type: "REST API"
  service:
    #socket: "jenkins.sock"
    parameters: [ "service", "start", "--templates", "/templates"]
created_flag_file: "{{ .InstanceName }}/forjj-{{ .Name }}.yaml"
actions:
  common:
    flags:
      forjj-infra:
        help: "Name of the Infra repository to use"
      jenkins-debug:
        help: "To activate jenkins debug information"
      forjj-source-mount:
        help: "Where the source dir is located for jenkins plugin."
  create:
    help: "Create a jenkins instance source code."
    flags:
      # Options related to source code
      forjj-instance-name:
        help: "Name of the jenkins instance to create given by forjj."
      forjj-organization:
        help: "Organization name used in the docker repo name if --docker-repoimage not set."
      docker-image:
        help: "Base docker image name to use in Dockerfile"
        default: "jenkins"
        group: "source"
      docker-image-version:
        help: "Base docker image version to use in Dockerfile"
        group: "source"
      docker-repoimage:
        help: "Repository name containing your base docker image name to use in Dockerfile"
        group: "source"
      maintainer:
        help: "Jenkins image maintainer"
        group: "source"
      features:
        help: "List of features to add to jenkins features.lst."
        group: "source"
      # Options related to deployment
      deploy-to:
        default: "docker"
        help: "Where this jenkins source code will be deployed. Supports 'docker'. Future would be 'marathon', 'dcos' and 'host'"
        group: "deploy"
      service-addr:
        required: true
        help: "CNAME or IP address of the expected jenkins instance"
        group: "deploy"
      service-port:
        default: "8080"
        help: "Expected jenkins instance port number."
        group: "deploy"
  update:
    help: "update a jenkins instance source code"
    flags:
      forjj-instance-name:
        help: "Name of the jenkins instance to update given by forjj."
      docker-image-version:
        help: "Base docker image version to use in Dockerfile"
        group: "source"
      docker-image:
        help: "Base docker image name to use in Dockerfile"
        default: "jenkins"
        group: "source"
      docker-repoimage:
        help: "Repository name containing your base docker image name to use in Dockerfile"
        group: "source"
      maintainer:
        help: "Jenkins image maintainer"
        group: "source"
      features-add:
        help: "List of features to add to jenkins."
  maintain:
    help: "Instantiate jenkins thanks to source code."
